{{- if .Values.monitoring.enabled }}
{{- if .Values.prometheus.grafana.enabled }}
{{- if .Values.prometheus.grafana.dashboardConfigMap.enabled }}
{{- $dashboardJson := "" }}
{{- if .Values.prometheus.grafana.dashboardConfigMap.dashboardJson }}
{{- $dashboardJson = .Values.prometheus.grafana.dashboardConfigMap.dashboardJson }}
{{- else if .Files.Get "files/grafana-dashboard.json" }}
{{- $dashboardJson = .Files.Get "files/grafana-dashboard.json" }}
{{- end }}
{{- if $dashboardJson }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: counter-service-dashboard
  namespace: {{ .Values.monitoring.namespace | default .Values.namespace }}
  labels:
    grafana_dashboard: "1"
    app: counter-service
data:
  counter-service-dashboard.json: |
{{ $dashboardJson | indent 4 }}
{{- end }}
{{- end }}
{{- end }}
{{- end }}

